[
	{
		"old_id":"24",
		"name":"Always True",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"1",
		"then_condition":" ",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2012-08-17 12:59:52",
		"modified":"2013-02-27 12:46:43",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":null,
		"revision":"1",
		"old_parent_id":"0",
		"lft":"1",
		"rgt":"2",
		"deleted":"0",
		"record_flags":"0",
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-2c34-4f91-b622-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"94",
		"name":"terminate other child node",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"1",
		"then_condition":"  $sib = $object->siblings();\r\n    $nodes = array();\r\n    if (is_array($sib)) {\r\n        foreach ($sib as $s) {\r\n            $nodes[] = $s['id'];\r\n        }\r\n        $object->terminateNodes($nodes);\r\n    }",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-02-18 16:42:32",
		"modified":"2013-07-11 11:55:26",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":"0",
		"revision":"1",
		"old_parent_id":"0",
		"lft":"3",
		"rgt":"4",
		"deleted":"0",
		"record_flags":"0",
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-36c0-4c46-9dc4-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"95",
		"name":"Approved Issue For Fixing ",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"1",
		"then_condition":"if (isset($object->data['entity']['bug_type']) && !empty($object->data['entity']['bug_type'])) {\r\n    $ticketType = current(\\module\\cases\\model\\bug_types::getInstance(array(), true)->read($object->data['entity']['bug_type']));\r\n    $type = $ticketType['bu",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-02-19 18:37:39",
		"modified":"2013-03-18 13:57:21",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":null,
		"revision":"1",
		"old_parent_id":"0",
		"lft":"5",
		"rgt":"6",
		"deleted":"0",
		"record_flags":"0",
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-3bd4-4960-8dbf-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"96",
		"name":"Deferred choice",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"1",
		"then_condition":"$sib = $object->siblings();\r\n    $nodes = array();\r\n    if (is_array($sib)) {\r\n        foreach ($sib as $s) {\r\n            $nodes[] = $s['id'];\r\n        }\r\n        $object->terminateNodes($nodes);\r\n    }",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-02-19 20:58:33",
		"modified":"2013-02-27 12:48:01",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":null,
		"revision":"1",
		"old_parent_id":"0",
		"lft":"7",
		"rgt":"8",
		"deleted":"0",
		"record_flags":"0",
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-40e8-42c9-98ef-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"97",
		"name":"Sibling",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"1",
		"then_condition":"$sib = $object->siblings();\r\n    $nodes = array();\r\n    if (is_array($sib)) {\r\n        foreach ($sib as $s) {\r\n            $nodes[] = $s['id'];\r\n        }\r\n        $object->terminateNodes($nodes);\r\n    }\r\n    ",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-02-20 15:30:44",
		"modified":"2013-02-27 12:48:18",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":null,
		"revision":"1",
		"old_parent_id":"0",
		"lft":"9",
		"rgt":"10",
		"deleted":"0",
		"record_flags":"0",
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-45fc-4c2b-b104-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"98",
		"name":"Action \"Implemented On production\"",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"1",
		"then_condition":"    $object->exitNode($object->node());",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-02-21 09:01:00",
		"modified":"2013-02-27 12:48:34",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":null,
		"revision":"1",
		"old_parent_id":"0",
		"lft":"11",
		"rgt":"12",
		"deleted":"0",
		"record_flags":"0",
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-4b10-4218-b3c5-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"99",
		"name":"Deem approve for support",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"1",
		"then_condition":"if (isset($object->data['entity']['type_id']) && !empty($object->data['entity']['type_id'])) {\r\n    $ticketType = current(\\module\\cases\\model\\config_ticket_types::getInstance(array(), true)->read($object->data['entity']['type_id']));\r\n    if (strcasecmp($",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-02-21 09:04:27",
		"modified":"2013-02-27 12:48:49",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":null,
		"revision":"1",
		"old_parent_id":"0",
		"lft":"13",
		"rgt":"14",
		"deleted":"0",
		"record_flags":"0",
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-50ec-42e3-9834-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"100",
		"name":"Action \"Accept For Fixing\"",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"1",
		"then_condition":"$object->data['entity']['owned_by']=\\tushar\\user::read('id');\r\n$primaryKey=$object->entityObj->primaryKey;\r\nupdate(array('owned_by'=>$object->data['entity']['owned_by']))\r\n->from($object->entityObj)\r\n->where($object->entityObj->primaryKey,$object->data['e",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-02-21 11:36:10",
		"modified":"2013-03-18 16:19:21",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":null,
		"revision":"1",
		"old_parent_id":"0",
		"lft":"15",
		"rgt":"16",
		"deleted":"0",
		"record_flags":"0",
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-5600-49f2-870e-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"101",
		"name":"Check for open issues in sprint backlog",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"1",
		"then_condition":"if (isset($object->data['entity']) && isset($object->data['entity']['id']) && !empty($object->data['entity']['id'])) {\r\n    $nodeID = $object->node();\r\n\/\/ find any non completed task and stop approval\r\n\r\n    $completedStages = \\select(\"id\")\r\n            -",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-02-21 13:24:31",
		"modified":"2013-02-27 16:19:40",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":null,
		"revision":"1",
		"old_parent_id":"0",
		"lft":"17",
		"rgt":"18",
		"deleted":"0",
		"record_flags":"0",
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-5b14-409e-9ab9-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"102",
		"name":"Stage \"Under Review\"",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"1",
		"then_condition":"$nodeID = $object->node();\r\nif (isset($object->data['entity']['type_id']) && !empty($object->data['entity']['type_id'])) {\r\n    $ticketType = \r\n\\current(\\module\\cases\\model\\config_ticket_types::getInstance(array(), true)\r\n                    ->read($objec",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-02-26 18:44:00",
		"modified":"2013-02-27 12:49:41",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":null,
		"revision":"1",
		"old_parent_id":"0",
		"lft":"19",
		"rgt":"20",
		"deleted":"0",
		"record_flags":"0",
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-608c-489b-a265-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"106",
		"name":"Action \"Mark As Duplicate\"",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"1",
		"then_condition":"$actors=array(array('foreign_key_model'=>'users','foreign_key'=>\\tushar\\user::read('id')));\r\nforeach(\r\n\\select('user_id')->from(\\module\\cases\\model\\project_actors::getInstance(array(),true))->joinInner('project_actor_roles')\r\n->inserted()\r\n->where('projec",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-02-27 18:23:02",
		"modified":null,
		"created_by":"1",
		"modified_by":null,
		"owned_by":null,
		"revision":"1",
		"old_parent_id":"0",
		"lft":"21",
		"rgt":"22",
		"deleted":"0",
		"record_flags":"0",
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-7540-4fd4-8ab9-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"107",
		"name":"Add Issues to current active sprint",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"isset($object->data['entity']['project_id']) && !empty($object->data['entity']['project_id'])",
		"then_condition":"$systemDate = \\tushar\\locale::systemDate() . \" \" . \\tushar\\locale::systemTime();\r\n$springObj = \\module\\cases\\model\\sprints::getInstance(array(), true);\r\n$sprint = \\select(\"*\")\r\n        ->from($springObj)\r\n        ->where('project_id', $object->data['entit",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-03-01 13:42:59",
		"modified":null,
		"created_by":"1",
		"modified_by":null,
		"owned_by":null,
		"revision":"1",
		"old_parent_id":"0",
		"lft":"23",
		"rgt":"24",
		"deleted":"0",
		"record_flags":"0",
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-7b1c-49c9-93c6-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"108",
		"name":"Approved",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"1",
		"then_condition":"$object->exitNode($object->node());",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-03-15 20:41:57",
		"modified":"2013-03-15 20:47:32",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":null,
		"revision":"1",
		"old_parent_id":"0",
		"lft":"25",
		"rgt":"26",
		"deleted":"0",
		"record_flags":"0",
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-8030-40d5-b446-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"109",
		"name":"ACTION \"Won't fix it\"",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"1",
		"then_condition":"    $stages = array(\"Won't Fix\");\r\n    $nodeID = $object->node();\r\n    $object->afterSerial($nodeID, $stages);\r\n    $object->exitNode($nodeID);\r\n",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-03-18 12:50:49",
		"modified":"2013-03-18 14:30:17",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":null,
		"revision":"1",
		"old_parent_id":"0",
		"lft":"27",
		"rgt":"28",
		"deleted":"0",
		"record_flags":"0",
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-85a8-4715-86a2-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"110",
		"name":"Action \"Mark As Completed\"",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"1",
		"then_condition":"    $nodeID = $object->node();\r\n    $object->exitNode($nodeID);\r\n",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-03-18 14:12:26",
		"modified":"2013-03-18 17:51:10",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":null,
		"revision":"1",
		"old_parent_id":"0",
		"lft":"29",
		"rgt":"30",
		"deleted":"0",
		"record_flags":"0",
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-8abc-4a39-820a-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"111",
		"name":"Action \"Accept In Sprint\"",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"1",
		"then_condition":"    $nodeID = $object->node();\r\n    $object->exitNode($nodeID);",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-03-18 16:21:34",
		"modified":null,
		"created_by":"1",
		"modified_by":null,
		"owned_by":null,
		"revision":"1",
		"old_parent_id":"0",
		"lft":"31",
		"rgt":"32",
		"deleted":"0",
		"record_flags":"0",
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-9098-4095-a997-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"112",
		"name":"Action \"Mark Invalid\"",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"1",
		"then_condition":"    $nodeID = $object->node();\r\n    $stages = array(\"Invalid\");\r\n    $object->afterSerial($nodeID, $stages);\r\n    $object->exitNode($nodeID);",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-03-18 16:23:13",
		"modified":null,
		"created_by":"1",
		"modified_by":null,
		"owned_by":null,
		"revision":"1",
		"old_parent_id":"0",
		"lft":"33",
		"rgt":"34",
		"deleted":"0",
		"record_flags":"0",
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-9610-495f-9f0f-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"113",
		"name":"Action \"Submit For Testing\"",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"1",
		"then_condition":"    $nodeID = $object->node();\r\n    $object->exitNode($nodeID);",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-03-18 16:25:31",
		"modified":null,
		"created_by":"1",
		"modified_by":null,
		"owned_by":null,
		"revision":"1",
		"old_parent_id":"0",
		"lft":"35",
		"rgt":"36",
		"deleted":"0",
		"record_flags":"0",
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-9b24-45d1-9855-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"114",
		"name":"Action \"Accept As Ship Ready\"",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"1",
		"then_condition":"    $nodeID = $object->node();\r\n    $object->exitNode($nodeID);",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-03-18 16:27:47",
		"modified":null,
		"created_by":"1",
		"modified_by":null,
		"owned_by":null,
		"revision":"1",
		"old_parent_id":"0",
		"lft":"37",
		"rgt":"38",
		"deleted":"0",
		"record_flags":"0",
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-a09c-473f-a3fe-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"115",
		"name":"Action \"Migrated to Production\"",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"1",
		"then_condition":"    $nodeID = $object->node();\r\n    $object->exitNode($nodeID);",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-03-18 16:31:27",
		"modified":"2013-03-18 16:34:36",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":null,
		"revision":"1",
		"old_parent_id":"0",
		"lft":"39",
		"rgt":"40",
		"deleted":"0",
		"record_flags":"0",
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-a5b0-4df6-b11a-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"116",
		"name":"Action \"Skip Production\"",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"1",
		"then_condition":"    $nodeID = $object->node();\r\n    $object->exitNode($nodeID);",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-03-18 16:33:02",
		"modified":"2013-03-18 16:34:59",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":null,
		"revision":"1",
		"old_parent_id":"0",
		"lft":"41",
		"rgt":"42",
		"deleted":"0",
		"record_flags":"0",
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-ab28-4e1a-9a45-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"117",
		"name":"Action \"Meeting Completed\"",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"1",
		"then_condition":"    $nodeID = $object->node();\r\n    $object->exitNode($nodeID);",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-03-18 16:38:53",
		"modified":null,
		"created_by":"1",
		"modified_by":null,
		"owned_by":null,
		"revision":"1",
		"old_parent_id":"0",
		"lft":"43",
		"rgt":"44",
		"deleted":"0",
		"record_flags":"0",
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-b03c-47da-b524-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"105",
		"name":"Flexflow Action \"Cannot Duplicate Issue\"",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"1",
		"then_condition":"\t    $stage = 'document closed';\r\n            $actors=array(array('foreign_key_model'=>'users','foreign_key'=>\\tushar\\user::read('id')));\r\nforeach(\r\n\\select('user_id')->from(\\module\\cases\\model\\project_actors::getInstance(array(),true))->joinInner('projec",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-02-27 18:21:13",
		"modified":null,
		"created_by":"1",
		"modified_by":null,
		"owned_by":null,
		"revision":"1",
		"old_parent_id":"0",
		"lft":"45",
		"rgt":"46",
		"deleted":"0",
		"record_flags":"0",
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-702c-45fa-8200-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"18",
		"name":"Leads",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"afterProcessData",
		"if_condition":"!isset($object->data['owned_by'])",
		"then_condition":"$object->data['owned_by']=\\tushar\\user::read('id');\r\n$object->data['__owned_by']=\\tushar\\user::read('name');\r\n",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2012-08-09 13:02:11",
		"modified":"2013-09-11 19:27:13",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":"0",
		"revision":"1",
		"old_parent_id":"0",
		"lft":"53",
		"rgt":"54",
		"deleted":"0",
		"record_flags":"0",
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-1208-4dae-9573-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"118",
		"name":"Test RULE FOR JSON RPC",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"$object->param(\"child\") == 1",
		"then_condition":"$object->set(\"destination_location\",\"X\/Y\/12\");",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-05-27 21:35:28",
		"modified":"2013-05-27 21:42:45",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":null,
		"revision":"1",
		"old_parent_id":"0",
		"lft":"57",
		"rgt":"58",
		"deleted":"0",
		"record_flags":"0",
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-b550-4790-9b15-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"131",
		"name":"Action \"Approved By Account Manager\"",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"1",
		"then_condition":"    $nodeID = $object->node();\r\n    $object->exitNode($nodeID);",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-09-05 21:39:02",
		"modified":null,
		"created_by":"1",
		"modified_by":null,
		"owned_by":"1",
		"revision":"1",
		"old_parent_id":"0",
		"lft":"77",
		"rgt":"78",
		"deleted":"0",
		"record_flags":null,
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-ea0c-4b5f-a656-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"132",
		"name":"Supplier Invoice Approval",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"$object->data['total'] < 5000",
		"then_condition":"$object->exitNode($object->node());",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-09-06 13:23:05",
		"modified":"2013-09-06 14:11:32",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":"1",
		"revision":"1",
		"old_parent_id":"0",
		"lft":"79",
		"rgt":"80",
		"deleted":"0",
		"record_flags":null,
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-ef20-4c33-9338-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"135",
		"name":"Auto process",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"1",
		"then_condition":"$object->setRUN($object->node(),true);",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-10-10 17:03:14",
		"modified":"2013-10-11 23:39:25",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":"1",
		"revision":"1",
		"old_parent_id":"0",
		"lft":"85",
		"rgt":"86",
		"deleted":"0",
		"record_flags":null,
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-fe5c-48bc-89e5-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"137",
		"name":"Deny",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"1",
		"then_condition":"$object->terminateSelf(true);",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-10-12 10:31:37",
		"modified":null,
		"created_by":"1",
		"modified_by":null,
		"owned_by":"1",
		"revision":"1",
		"old_parent_id":"0",
		"lft":"89",
		"rgt":"90",
		"deleted":"0",
		"record_flags":null,
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-0884-4e00-bc4c-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"138",
		"name":"Send Ambulance (Choice=1)",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"$object->data['entity']['amount'] = 1",
		"then_condition":"  $sib = $object->siblings();\r\n    $nodes = array();\r\n    if (is_array($sib)) {\r\n        foreach ($sib as $s) {\r\n            $nodes[] = $s['id'];\r\n        }\r\n        $object->terminateNodes($nodes);\r\n    }",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-10-12 10:53:18",
		"modified":"2013-10-12 11:09:26",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":"1",
		"revision":"1",
		"old_parent_id":"0",
		"lft":"91",
		"rgt":"92",
		"deleted":"0",
		"record_flags":null,
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-0d98-4bd0-9707-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"139",
		"name":"Send Police Car (Choice=2)",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"$object->data['entity']['amount'] = 2",
		"then_condition":"  $sib = $object->siblings();\r\n    $nodes = array();\r\n    if (is_array($sib)) {\r\n        foreach ($sib as $s) {\r\n            $nodes[] = $s['id'];\r\n        }\r\n        $object->terminateNodes($nodes);\r\n    }",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-10-12 11:07:58",
		"modified":"2013-10-12 11:19:06",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":"1",
		"revision":"1",
		"old_parent_id":"0",
		"lft":"93",
		"rgt":"94",
		"deleted":"0",
		"record_flags":null,
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-1310-461f-a0a5-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"140",
		"name":"Multi Choice",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"1",
		"then_condition":"$nodeID = array();\r\n$outgoing = $object->outgoing();\r\nif (isset($outgoing['log_nodes']) && is_array($outgoing['log_nodes'])) {\r\n    foreach ($outgoing['log_nodes'] as $log) {\r\n        if (isset($object->data['entity']['choice'])) {\r\n            switch ($object->data['entity']['choice']) {\r\n                case \"Fire In Building\":\r\n                    if (!in_array($log['stage_name'], array('Dispatch Ambulance', 'Dispatch Fire Truck', 'Dispatch Police Car')))\r\n                        $nodeID[] = $log['id'];\r\n                    break;\r\n                case \"Person got heart attack\":\r\n                    if (!in_array($log['stage_name'], array('dispatch ambulance')))\r\n                        $nodeID[] = $log['id'];\r\n                    break;\r\n\r\n                case \"Car accident\":\r\n                    if (!in_array($log['stage_name'], array('dispatch ambulance', 'dispatch police car')))\r\n                        $nodeID[] = $log['id'];\r\n                    break;\r\n            }\r\n        }\r\n    }\r\n}\r\nif(!empty($nodeID)){\r\n    $object->terminateNodes($nodeID);\r\n}",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-10-12 14:45:12",
		"modified":"2013-10-14 19:19:54",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":"1",
		"revision":"1",
		"old_parent_id":"0",
		"lft":"95",
		"rgt":"96",
		"deleted":"0",
		"record_flags":null,
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"52611f7e-1824-491a-ba34-1d890acef1b9",
		"parent_id":""
	},
	{
		"old_id":"0",
		"name":"Approve",
		"description":"",
		"runlevel":"2",
		"filter_path":"-",
		"event":"",
		"if_condition":"1",
		"then_condition":"$object->exitNode();",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-10-29 17:29:57",
		"modified":null,
		"created_by":"1",
		"modified_by":null,
		"owned_by":"1",
		"revision":"2",
		"old_parent_id":null,
		"lft":"105",
		"rgt":"106",
		"deleted":"0",
		"record_flags":null,
		"md5":null,
		"action_id":null,
		"stage_id":null,
		"id":"526ff095-e048-459d-a63b-21e70aec906d",
		"parent_id":""
	},
	{
		"old_id":"0",
		"name":"Set Flag Ready To Deliver",
		"description":"",
		"runlevel":"2",
		"filter_path":"\/module\/stock\/model\/delivery_orders",
		"event":"",
		"if_condition":"1",
		"then_condition":"$object->exitNode();",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-12-07 21:40:50",
		"modified":null,
		"created_by":"1",
		"modified_by":null,
		"owned_by":"1",
		"revision":"1",
		"old_parent_id":null,
		"lft":"125",
		"rgt":"126",
		"deleted":"0",
		"record_flags":null,
		"md5":null,
		"action_id":"57",
		"stage_id":"0",
		"id":"52a395e2-b0e4-4b4c-bb61-7af40a550b97",
		"parent_id":""
	},
	{
		"old_id":"0",
		"name":"Set Flag Waiting For Delivery",
		"description":"",
		"runlevel":"2",
		"filter_path":"\/module\/stock\/model\/delivery_orders",
		"event":"",
		"if_condition":"1",
		"then_condition":"$object->exitNode();",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-12-07 21:41:44",
		"modified":null,
		"created_by":"1",
		"modified_by":null,
		"owned_by":"1",
		"revision":"1",
		"old_parent_id":null,
		"lft":"127",
		"rgt":"128",
		"deleted":"0",
		"record_flags":null,
		"md5":null,
		"action_id":"56",
		"stage_id":"0",
		"id":"52a39618-9538-4379-aa02-02280a550b97",
		"parent_id":""
	},
	{
		"old_id":"0",
		"name":"Overdue",
		"description":"",
		"runlevel":"2",
		"filter_path":"\/module\/stock\/model\/delivery_orders",
		"event":"",
		"if_condition":"1",
		"then_condition":"$object->exitNode();",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-12-07 21:42:49",
		"modified":null,
		"created_by":"1",
		"modified_by":null,
		"owned_by":"1",
		"revision":"1",
		"old_parent_id":null,
		"lft":"129",
		"rgt":"130",
		"deleted":"0",
		"record_flags":null,
		"md5":null,
		"action_id":"58",
		"stage_id":"0",
		"id":"52a39659-4358-4c7d-a9e6-027c0a550b97",
		"parent_id":""
	},
	{
		"old_id":"0",
		"name":"Delivery Order 'Check Availability'",
		"description":"",
		"runlevel":"2",
		"filter_path":"\/module\/stock\/model\/delivery_orders",
		"event":"",
		"if_condition":"1",
		"then_condition":"$data = $object->data['entity'];\r\nif(array_key_exists(\"delivery_order_lines\", $data)) {\r\n        foreach($data['delivery_order_lines'] as $line){\r\n            if (!$line['deleted']){\r\n                $product = current(\\module\\product\\model\\products::getInstance()->read($line['product_id']));\r\n                 $qty = isset($product['quantity'])?$product['quantity']:0.0;\r\n                if ($line['quantity'] > $qty){\r\n\t\t\tthrow new \\Exception(sprintf(__(\"Available quantity for product \\\"%s\\\"is low. Please do inventory update\",\"module\"), $product['name']));        \t\t}\r\n                }\t\r\n    }    \r\n}\r\n\r\n$object->exitNode();",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-12-07 21:44:53",
		"modified":"2013-12-21 18:30:46",
		"created_by":"1",
		"modified_by":"117",
		"owned_by":"1",
		"revision":"14",
		"old_parent_id":null,
		"lft":"131",
		"rgt":"132",
		"deleted":"0",
		"record_flags":null,
		"md5":null,
		"action_id":"59",
		"stage_id":"0",
		"id":"52a396d5-8cb8-4fe6-bb1e-027e0a550b97",
		"parent_id":""
	},
	{
		"old_id":"0",
		"name":"Action 'Force Availability'",
		"description":"",
		"runlevel":"2",
		"filter_path":"\/module\/stock\/model\/delivery_orders",
		"event":"",
		"if_condition":"1",
		"then_condition":"$object->exitNode();",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-12-07 21:45:43",
		"modified":null,
		"created_by":"1",
		"modified_by":null,
		"owned_by":"1",
		"revision":"1",
		"old_parent_id":null,
		"lft":"133",
		"rgt":"134",
		"deleted":"0",
		"record_flags":null,
		"md5":null,
		"action_id":"60",
		"stage_id":"0",
		"id":"52a39707-9f8c-4e8d-990c-027e0a550b97",
		"parent_id":""
	},
	{
		"old_id":"0",
		"name":"Action 'Deliver'",
		"description":"",
		"runlevel":"2",
		"filter_path":"\/module\/stock\/model\/delivery_orders",
		"event":"",
		"if_condition":"1",
		"then_condition":"$object->exitNode();",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-12-07 21:52:37",
		"modified":"2013-12-07 21:53:00",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":"1",
		"revision":"2",
		"old_parent_id":null,
		"lft":"135",
		"rgt":"136",
		"deleted":"0",
		"record_flags":null,
		"md5":null,
		"action_id":"61",
		"stage_id":"0",
		"id":"52a398a5-4e94-4049-8964-027d0a550b97",
		"parent_id":""
	},
	{
		"old_id":"0",
		"name":"Action 'Pack'",
		"description":"",
		"runlevel":"2",
		"filter_path":"\/module\/stock\/model\/delivery_orders",
		"event":"",
		"if_condition":"1",
		"then_condition":"$object->exitNode();",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-12-07 21:54:38",
		"modified":null,
		"created_by":"1",
		"modified_by":null,
		"owned_by":"1",
		"revision":"1",
		"old_parent_id":null,
		"lft":"137",
		"rgt":"138",
		"deleted":"0",
		"record_flags":null,
		"md5":null,
		"action_id":"63",
		"stage_id":"0",
		"id":"52a3991e-91b4-48df-9d8a-027c0a550b97",
		"parent_id":""
	},
	{
		"old_id":"0",
		"name":"Action 'Approve'",
		"description":"",
		"runlevel":"2",
		"filter_path":"\/module\/stock\/model\/delivery_orders",
		"event":"",
		"if_condition":"1",
		"then_condition":" $object->exitNode();",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-12-09 15:03:45",
		"modified":"2013-12-09 21:42:06",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":"1",
		"revision":"2",
		"old_parent_id":null,
		"lft":"149",
		"rgt":"150",
		"deleted":"0",
		"record_flags":null,
		"md5":null,
		"action_id":"3",
		"stage_id":"0",
		"id":"52a5dbd1-b8fc-4d95-879a-6e1e0a550b97",
		"parent_id":""
	},
	{
		"old_id":"0",
		"name":"Action 'Dispatch'",
		"description":"",
		"runlevel":"2",
		"filter_path":"\/module\/stock\/model\/delivery_orders",
		"event":"",
		"if_condition":"1",
		"then_condition":"$object->exitNode();",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-12-09 17:43:34",
		"modified":null,
		"created_by":"1",
		"modified_by":null,
		"owned_by":"1",
		"revision":"1",
		"old_parent_id":null,
		"lft":"151",
		"rgt":"152",
		"deleted":"0",
		"record_flags":null,
		"md5":null,
		"action_id":"44",
		"stage_id":"0",
		"id":"52a60146-ad1c-4628-9fbc-7c670a550b97",
		"parent_id":""
	},
	{
		"old_id":"0",
		"name":"Action 'Release Order'",
		"description":"",
		"runlevel":"2",
		"filter_path":"\/module\/stock\/model\/delivery_orders",
		"event":"",
		"if_condition":"1",
		"then_condition":" $object->exitNode();",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-12-09 22:15:54",
		"modified":"2013-12-18 22:46:32",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":"1",
		"revision":"2",
		"old_parent_id":null,
		"lft":"155",
		"rgt":"156",
		"deleted":"0",
		"record_flags":null,
		"md5":null,
		"action_id":"76",
		"stage_id":"0",
		"id":"52a6411a-bccc-4e36-82ba-14e70a550b97",
		"parent_id":""
	},
	{
		"old_id":"0",
		"name":"Action 'Return Shipment\"",
		"description":"",
		"runlevel":"2",
		"filter_path":"\/module\/stock\/model\/delivery_orders",
		"event":"",
		"if_condition":"1",
		"then_condition":"$object->exitNode();",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2013-12-23 17:18:50",
		"modified":null,
		"created_by":"1",
		"modified_by":null,
		"owned_by":"1",
		"revision":"1",
		"old_parent_id":null,
		"lft":"161",
		"rgt":"162",
		"deleted":"0",
		"record_flags":null,
		"md5":null,
		"action_id":"65",
		"stage_id":"0",
		"id":"52b8707a-4c98-49e7-9202-5b7a0a550b97",
		"parent_id":""
	},
	{
		"old_id":"0",
		"name":"Confirm",
		"description":"",
		"runlevel":"2",
		"filter_path":"\/module\/stock\/model\/inbound_shipments",
		"event":"",
		"if_condition":"1",
		"then_condition":" if (!$object->isLogSet()) {\r\n            \/\/  set nodes\r\n            $object->setWorkflowLog(array(array('can_edit' => 1, 'foreign_key' => \\tushar\\user::read('id'), 'foreign_key_model' => 'users')));\r\n        }\r\n        \/\/  then set draft as current node.->invoke enter event for current stage\r\n        $node = $object->node($object->nodeID());\r\n        \/\/ check if node is valid and exists in log.\r\n        if ($node['status'] == 'open') {\r\n            $object->logAction($node['id']);\r\n            \/\/ exit current stage\r\n            $object->exitNode();\r\n        }",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2014-01-13 17:41:18",
		"modified":"2014-01-13 22:06:24",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":"1",
		"revision":"2",
		"old_parent_id":null,
		"lft":"189",
		"rgt":"190",
		"deleted":"0",
		"record_flags":null,
		"md5":null,
		"action_id":"91",
		"stage_id":"0",
		"id":"52d4253e-46c0-40b2-9fc2-79860ac22bdf",
		"parent_id":""
	},
	{
		"old_id":"0",
		"name":"Receive",
		"description":"",
		"runlevel":"2",
		"filter_path":"\/module\/stock\/model\/inbound_shipments",
		"event":"",
		"if_condition":"1",
		"then_condition":"$object->exitNode();",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2014-01-13 17:49:32",
		"modified":null,
		"created_by":"1",
		"modified_by":null,
		"owned_by":"1",
		"revision":"1",
		"old_parent_id":null,
		"lft":"191",
		"rgt":"192",
		"deleted":"0",
		"record_flags":null,
		"md5":null,
		"action_id":"92",
		"stage_id":"0",
		"id":"52d4272c-e158-45f7-afbb-7a0c0ac22bdf",
		"parent_id":""
	},
	{
		"old_id":"0",
		"name":"Reset to Draft",
		"description":"",
		"runlevel":"2",
		"filter_path":"\/module\/stock\/model\/inbound_shipments",
		"event":"",
		"if_condition":"1",
		"then_condition":"$object->exitNode();",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2014-01-13 17:53:05",
		"modified":null,
		"created_by":"1",
		"modified_by":null,
		"owned_by":"1",
		"revision":"1",
		"old_parent_id":null,
		"lft":"193",
		"rgt":"194",
		"deleted":"0",
		"record_flags":null,
		"md5":null,
		"action_id":"93",
		"stage_id":"0",
		"id":"52d42801-eaa8-40fe-8ecc-7a0a0ac22bdf",
		"parent_id":""
	},
	{
		"old_id":"0",
		"name":"Validate",
		"description":"",
		"runlevel":"2",
		"filter_path":"\/module\/stock\/model\/inbound_shipments",
		"event":"",
		"if_condition":"1",
		"then_condition":"$object->exitNode();",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2014-01-13 17:56:07",
		"modified":null,
		"created_by":"1",
		"modified_by":null,
		"owned_by":"1",
		"revision":"1",
		"old_parent_id":null,
		"lft":"195",
		"rgt":"196",
		"deleted":"0",
		"record_flags":null,
		"md5":null,
		"action_id":"94",
		"stage_id":"0",
		"id":"52d428b7-5920-4dc0-95c5-7a300ac22bdf",
		"parent_id":""
	},
	{
		"old_id":"0",
		"name":"Issue validation",
		"description":"",
		"runlevel":"2",
		"filter_path":"\/module\/stock\/model\/transfer_orders",
		"event":"",
		"if_condition":"1",
		"then_condition":"\/\/ if not set, then set draft as current node.\r\n        \/\/  log is empty\r\n        if (!$object->isLogSet()) {\r\n            \/\/  set nodes\r\n            $object->setWorkflowLog(array(array('can_edit' => 1, 'foreign_key' => \\tushar\\user::read('id'), 'foreign_key_model' => 'users')));\r\n        }\r\n        \/\/  then set draft as current node.->invoke enter event for current stage\r\n        $node = $object->node($object->nodeID());\r\n        \/\/ check if node is valid and exists in log.\r\n$data = $object->data['entity'];\r\nif (array_key_exists(\"stock_moves\", $data)) {\r\n    $count = 0;\r\n    foreach ($data['stock_moves'] as $key => $value) {\r\n        if (!isset($value['deleted']) || (isset($value['deleted']) && $value['deleted'] != '1')) {\r\n            $count+=1;\r\n        }\r\n    }\r\n    if ($count <= '0') {\r\n        throw new \\Exception('Please Enter at least one Order Line');\r\n    } else {\r\n        $object->exitNode();\r\n    }\r\n} else {\r\n    throw new \\Exception('Please Enter at least one Order Line');\r\n}",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2014-01-24 15:24:27",
		"modified":"2014-01-24 23:48:17",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":"1",
		"revision":"3",
		"old_parent_id":null,
		"lft":"201",
		"rgt":"202",
		"deleted":"0",
		"record_flags":null,
		"md5":null,
		"action_id":"96",
		"stage_id":"0",
		"id":"52e285ab-6d04-4f27-b88e-2ed90ac22bdf",
		"parent_id":""
	},
	{
		"old_id":"0",
		"name":"Unissue",
		"description":"",
		"runlevel":"2",
		"filter_path":"\/module\/stock\/model\/transfer_orders",
		"event":"",
		"if_condition":"1",
		"then_condition":"$object->exitNode();",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2014-01-24 15:33:29",
		"modified":null,
		"created_by":"1",
		"modified_by":null,
		"owned_by":"1",
		"revision":"1",
		"old_parent_id":null,
		"lft":"203",
		"rgt":"204",
		"deleted":"0",
		"record_flags":null,
		"md5":null,
		"action_id":"97",
		"stage_id":"0",
		"id":"52e287c9-4d58-48d2-8a2d-32b60ac22bdf",
		"parent_id":""
	},
	{
		"old_id":"0",
		"name":"Process",
		"description":"If type of Transfer Order is Move, the move it Done state and mark related transactions to Done State. Else, create a Delivery Order for that document",
		"runlevel":"2",
		"filter_path":"\/module\/stock\/model\/transfer_orders",
		"event":"",
		"if_condition":"1",
		"then_condition":"$nodeID = $object->nodeID();\r\n$nextStages=$object->nextMoveToStages($nodeID);\r\n$nextStageList=array();\r\n$toData = $object->data['entity'];\r\n$smObject=\\module\\stock\\model\\stock_moves::getInstance();\r\nforeach ($nextStages as $id=>$stage) {\r\n    $nextStages[$id]['parent_id']=$nodeID; \r\n    if($toData['type'] == 'Move' ){\r\n        if(strcasecmp($stage['name'], 'Pending Shipment') == 0 ){\r\n            $nextStages[$id]['status']='canceled';\r\n            $nextStages[$id]['message'] = 'canceled';\r\n            $nextStageList[$id]=$nextStages[$id];\r\n        }\r\n        $sol = array();\r\n        foreach($toData['stock_moves'] as $line){\r\n           if(!(isset($line['deleted']) && $line['deleted'] == 1)){\r\n              $sol[] = $line[id];\r\n           }\r\n        }\r\n        \\update(array('status'=>'Done'))->{'\\\\module\\\\stock\\\\model\\\\stock_moves'}->where('id',$sol)->execute();\r\n    }elseif (strcasecmp($stage['name'],'Done') == 0 ) {\r\n             $nextStages[$id]['status']='canceled';\r\n             $nextStages[$id]['message'] = 'canceled';\r\n             $nextStageList[$id]=$nextStages[$id];\r\n             \/\/ to generate a DO\r\n             $doObject=\\module\\stock\\model\\delivery_orders::getInstance();\r\n             $toData['transfer_orders_id']=$toData['id'];\r\n             $toData=array_diff_key($toData,\r\n             array($doObject->primaryKey=>1,\r\n                   'status'=>1,\r\n                   '_acl'=>1,\r\n                   '_acl_edit'=>1,\r\n                   '_acl_delete'=>1));\r\n             if(isset($toData['stock_moves']) && is_array($toData['stock_moves'])){\r\n                 $toData['delivery_order_lines']=array();\r\n                 foreach($toData['stock_moves'] as $line){\r\n                     if(!(isset($line['deleted']) && $line['deleted'] == 1)){\r\n                        unset($line['id']);\r\n                        $toData['delivery_order_lines'][]=$line;\r\n                     }\r\n                 }\r\n                 unset($toData['stock_moves']);\r\n             }\r\n             $toData['action'] = array('draft'=>'draft');\r\n             $doObject->save($toData,array('atomic'=>true, 'validate'=>FALSE));\r\n    }       \r\n}\r\n$nextStageList=array_merge($nextStageList,array_diff_key($nextStages,$nextStageList));\r\n$nextNodes=$object->logNextMoveToStages($nextStageList);\r\n$object->exitNode(null,$nextNodes);",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2014-01-24 15:51:07",
		"modified":"2014-02-01 18:53:09",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":"1",
		"revision":"29",
		"old_parent_id":null,
		"lft":"205",
		"rgt":"206",
		"deleted":"0",
		"record_flags":null,
		"md5":null,
		"action_id":"98",
		"stage_id":"0",
		"id":"52e28beb-ac14-4024-8336-340a0ac22bdf",
		"parent_id":""
	},
	{
		"old_id":"0",
		"name":"Shipped",
		"description":"",
		"runlevel":"2",
		"filter_path":"\/module\/stock\/model\/transfer_orders",
		"event":"",
		"if_condition":"1",
		"then_condition":"$dataTO=$object->data['entity'];\r\nif(is_array($dataTO)){\r\n   $do_id = \\select(array('id'))->from('\\\\module\\\\stock\\\\model\\\\delivery_orders')->where('transfer_orders_id',$dataTO['id'])->execute()->fetch(\\PDO::FETCH_COLUMN);\r\n   $doObj = \\module\\stock\\model\\delivery_orders::getInstance(array(), true);\r\n   $doData = current($doObj->read($do_id));\r\n   $doStages = array('Closed','Confirm Shipment','');\r\n   if (!in_array($doData['workflow_docs']['current_stages'], $doStages)){\r\n    throw new \\Exception(sprintf(__(\"Related Delivery Order \\\"%s\\\" must be Shipped to process this Transfer Order.\",\"module\"), $doData['name']));\r\n   }\r\n   $isObject=\\module\\stock\\model\\inbound_shipments::getInstance();\r\n   $dataTO['transfer_orders_id']=$dataTO['id'];\r\n  \r\n   $dataTO=array_diff_key($dataTO,\r\n   array($isObject->primaryKey=>1,\r\n   'status'=>1,\r\n   '_acl'=>1,\r\n   '_acl_edit'=>1,\r\n   '_acl_delete'=>1));\r\n   \r\n   \r\n   if(isset($dataTO['stock_moves']) && is_array($dataTO['stock_moves'])){\r\n       $dataTO['config_inbound_shipment_lines']=array();\r\n       foreach($dataTO['stock_moves'] as $line){\r\n           if(!(isset($line['deleted']) && $line['deleted'] == 1)){\r\n              unset($line['id']);\r\n              $dataTO['config_inbound_shipment_lines'][]=$line;\r\n           }\r\n       }\r\n       unset($dataTO['stock_moves']);\r\n   }\r\n   $dataTO['action'] = array('draft'=>'draft');\r\n   \r\n   if($isObject->save($dataTO,array('atomic'=>true, 'validate'=>FALSE))) {\r\n       $object->exitNode();\r\n   }\r\n}",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2014-01-24 15:53:49",
		"modified":"2014-01-30 19:45:37",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":"1",
		"revision":"34",
		"old_parent_id":null,
		"lft":"207",
		"rgt":"208",
		"deleted":"0",
		"record_flags":null,
		"md5":null,
		"action_id":"99",
		"stage_id":"0",
		"id":"52e28c8d-1c44-4c0c-9920-323f0ac22bdf",
		"parent_id":""
	},
	{
		"old_id":"0",
		"name":"fulfilled",
		"description":"",
		"runlevel":"2",
		"filter_path":"\/module\/stock\/model\/transfer_orders",
		"event":"",
		"if_condition":"1",
		"then_condition":"$dataTO=$object->data['entity'];\r\nif(is_array($dataTO)){\r\n   $is_id = \\select(array('id'))->from('\\\\module\\\\stock\\\\model\\\\inbound_shipments')->where('transfer_orders_id',$dataTO['id'])->execute()->fetch(\\PDO::FETCH_COLUMN);\r\n   $isObj = \\module\\stock\\model\\inbound_shipments::getInstance(array(), true);\r\n   $isData = current($isObj->read($is_id));\r\n   if (!in_array($isData['workflow_docs']['current_stages'], array('Done'))){\r\n    throw new \\Exception(sprintf(__(\"Related Inbound Shipment with Id \\\"%s\\\" must be in Done state to close this Transfer Order.\",\"module\"), $isData['id']));\r\n   }\r\n   $object->exitNode();  \r\n}",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2014-01-24 15:55:57",
		"modified":"2014-01-30 19:48:34",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":"1",
		"revision":"6",
		"old_parent_id":null,
		"lft":"209",
		"rgt":"210",
		"deleted":"0",
		"record_flags":null,
		"md5":null,
		"action_id":"100",
		"stage_id":"0",
		"id":"52e28d0d-fdfc-4cc1-8188-33010ac22bdf",
		"parent_id":""
	},
	{
		"old_id":"0",
		"name":"Issue Validation Inventory",
		"description":"",
		"runlevel":"2",
		"filter_path":"\/module\/stock\/model\/inventory",
		"event":"",
		"if_condition":"1",
		"then_condition":"\/\/ if not set, then set draft as current node.\r\n        \/\/  log is empty\r\n        if (!$object->isLogSet()) {\r\n            \/\/  set nodes\r\n            $object->setWorkflowLog(array(array('can_edit' => 1, 'foreign_key' => \\tushar\\user::read('id'), 'foreign_key_model' => 'users')));\r\n        }\r\n        \/\/  then set draft as current node.->invoke enter event for current stage\r\n        $node = $object->node($object->nodeID());\r\n        \/\/ check if node is valid and exists in log.\r\n$data = $object->data['entity'];\r\nif (array_key_exists(\"inventory_lines\", $data)) {\r\n    $count = 0;\r\n    foreach ($data['inventory_lines'] as $key => $value) {\r\n        if (!isset($value['deleted']) || (isset($value['deleted']) && $value['deleted'] != '1')) {\r\n            $count+=1;\r\n        }\r\n    }\r\n    if ($count <= '0') {\r\n\r\n        throw new \\Exception('Please Enter at least one Inventory Line');\r\n    } else {\r\n        $object->exitNode();\r\n    }\r\n} else {\r\n    throw new \\Exception('Please Enter at least one Inventory Line');\r\n}",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2014-01-24 17:52:58",
		"modified":"2014-01-24 23:33:56",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":"1",
		"revision":"20",
		"old_parent_id":null,
		"lft":"211",
		"rgt":"212",
		"deleted":"0",
		"record_flags":null,
		"md5":null,
		"action_id":"96",
		"stage_id":"0",
		"id":"52e2a87a-3a10-469d-99ca-3ee30ac22bdf",
		"parent_id":""
	},
	{
		"old_id":"0",
		"name":"Unissue Inventory",
		"description":"",
		"runlevel":"2",
		"filter_path":"\/module\/stock\/model\/inventory",
		"event":"",
		"if_condition":"1",
		"then_condition":"$object->exitNode();",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2014-01-24 17:56:21",
		"modified":null,
		"created_by":"1",
		"modified_by":null,
		"owned_by":"1",
		"revision":"1",
		"old_parent_id":null,
		"lft":"213",
		"rgt":"214",
		"deleted":"0",
		"record_flags":null,
		"md5":null,
		"action_id":"97",
		"stage_id":"0",
		"id":"52e2a945-f7d8-4658-9d46-3ee20ac22bdf",
		"parent_id":""
	},
	{
		"old_id":"0",
		"name":"Validate Inventory",
		"description":"",
		"runlevel":"2",
		"filter_path":"\/module\/stock\/model\/inventory",
		"event":"",
		"if_condition":"1",
		"then_condition":"$inc = \\select(array('stock_moves.destination_location_id as location', 'sum(stock_moves.quantity) as quantity', 'location_destination.type as type'))\r\n                            ->from('\\\\module\\\\stock\\\\model\\\\stock_moves')\r\n                            ->join('location_destination')\r\n                            ->where(array('stock_moves.status' => array('Available', 'Waiting Availability'),\r\n                                'stock_moves.product_id' => '14'))\r\n                            ->group(array('stock_moves.product_id', 'stock_moves.destination_location_id', 'location_destination.type'))\r\n                            ->limit(0)\r\n                            ->inserted()\r\n                            ->execute()->fetchAll(\\PDO::FETCH_ASSOC);\r\n\r\n$qty = 0.0;\r\n\r\npr($inc);\r\n\r\nforeach ($inc as $line) {\r\n    if ($line['type'] == 'Internal Location') {\r\n        $qty+=floatval($line['quantity']);\r\n    }\r\n}\r\n\r\npr($qty);\r\n\r\nthrow new \\Exception(sprintf(__(\"Availabt \\\"%s\\\"idate\",\"module\"), 'zzz'));\r\n$object->exitNode();",
		"else_condition":"",
		"is_terminal":"0",
		"run_once":"0",
		"created":"2014-01-24 18:00:24",
		"modified":"2014-01-31 22:28:23",
		"created_by":"1",
		"modified_by":"1",
		"owned_by":"1",
		"revision":"69",
		"old_parent_id":null,
		"lft":"215",
		"rgt":"216",
		"deleted":"0",
		"record_flags":null,
		"md5":null,
		"action_id":"94",
		"stage_id":"0",
		"id":"52e2aa38-a8f8-4a70-a7b7-3e660ac22bdf",
		"parent_id":""
	}
]